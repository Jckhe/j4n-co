/**
 * @fileoverview Skype Panamericana Chatstyle main JS library
 * @author Margus Holland (margusholland@me.com)
 * @version 1.0
*/
if(typeof SCS=="undefined")var SCS={};SCS.Identifier=function(){var e=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",t=16,n="";for(var r=0;r<t;r++){var i=Math.floor(Math.random()*e.length);n+=e.substring(i,i+1)}return n};this.addId=function(t,n){if(typeof n=="undefined"||n=="")var n=e();return $(t).each(function(){$html=$(this).attr("id",n)}),$html.get(0)}},SCS.ErrorHandler=function(){var e={200:"OK",510:"Can’t find conversation",511:"Can’t find item",512:"Index must be integer and >= 0",513:"ID empty or undefined",514:"Unknown value",515:"Cocoa display controller dC undefined"};this.showError=function(t,n){var r="";return typeof t!="undefined"?typeof e[t]=="undefined"?!1:(typeof n!="undefined"&&n!=""?r=n+" : "+"["+t+"] "+e[t]:r="["+t+"] "+e[t],typeof debug!="undefined"&&debug==1&&console.log(r),r):!1}},SCS.Conversation=function(){var e=this,t,n=!1,r={};this._init=function(){if(t.length>0){var e=function(){var e=t.width();e<540?(t.addClass("compact"),r.name!="compact"&&(r.name="compact",r.left=23,_mode_right=23,dC.setMode_leftMargin_rightMargin_(r.name,r.left,r.right))):(t.removeClass("compact"),r.name!="default"&&(r.name="default",r.left=76,_mode_right=150,dC.setMode_leftMargin_rightMargin_(r.name,r.left,r.right)))};return $(window).scroll(function(){window.scrollY<11&&n==0&&(dC.scrollWindowToTopEvent(),n=!0),window.scrollY>10&&(n=!1)}),e(),$(window).resize(e),$(".item").css("display","none"),setTimeout(function(){$(".item").css("display","block")},1),SCS.err.showError(200,"_init")}return SCS.err.showError(510,"_init")},this._dc=function(){return typeof dC=="undefined"?SCS.err.showError(515,"_dc"):SCS.err.showError(200,"_dc")},this._item=function(){return t.length>0?($(".item .head .sender a:not(.profile)").live("click",function(e){var t=$(this);e.preventDefault(),dC.openConversationWithIdentity_(t.attr("href"))}),$(".item .head .sender img, .item .head .sender span.profile").live("click",function(e){var t=$(this);t.attr("data-sender")&&dC.showProfileOfIdentity_(t.attr("data-sender"))}),$(".item button").live("click",function(e){var t=$(this),n=$(this).closest(".item");t.hasClass("actions")&&dC.showContextMenuForID_(n.attr("id"))}),SCS.err.showError(200,"_item")):SCS.err.showError(510,"_item")},this._history=function(){return t.length>0?($(".item.history a").live("click",function(e){var t=$(this),n=$(this).closest(".history");e.preventDefault(),dC.loadHistoryInDays_(t.attr("href"))}),SCS.err.showError(200,"_history")):SCS.err.showError(510,"_history")},this._voicemail=function(){return t.length>0?($(".item.voicemail button").live("click",function(){var t=$(this),n=$(this).closest(".voicemail");if(t.hasClass("control")){var r=$(".progress",n);$(this).hasClass("stop")?dC.stopVoicemailWithID_(n.attr("id"))&&e.voicemailStop(n.attr("id")):dC.playVoicemailWithID_(n.attr("id"))&&e.voicemailPlay(n.attr("id"))}t.hasClass("delete")&&dC.stopVoicemailWithID_(n.attr("id"))&&dC.deleteVoicemailWithID_(n.attr("id"))&&n.animate({opacity:0,height:0},750,function(){n.remove()})}),SCS.err.showError(200,"_voicemail")):SCS.err.showError(510,"_voicemail")},this._message=function(){return t.length>0?($(".item.message button").live("click",function(e){var t=$(this),n=$(this).closest(".message");t.hasClass("edit")&&dC.startMessageEditWithID_(n.attr("id")),t.hasClass("delete")&&dC.removeMessageWithID_(n.attr("id"))}),$(".item.message.editable").live("mouseover",function(){var e=$(this);dC.isMessageEditable_(e.attr("id"))||e.removeClass("editable")}),$(".item.message.editable .body").live("dblclick",function(t){var n=$(this).closest(".item");if(n.find(".editMode").length>0)return;dC.isMessageEditableInline_(n.attr("id"))&&dC.startMessageInlineEditWithID_body_(n.attr("id"),$(".body",n).html())&&e.messageStartInlineEdit(n.attr("id"))}),$(window).bind("keyup",function(t){t.which==27&&$(".item .editMode").each(function(){var t=$(this).closest(".item");dC.cancelMessageInlineEditWithID_(t.attr("id"))&&e.messageEndInlineEdit(t.attr("id"))})}),$("body").bind("click",function(t){if($(t.target).hasClass("editMode"))return;$(".item .editMode").each(function(){var t=$(this).closest(".item");dC.cancelMessageInlineEditWithID_(t.attr("id"))&&e.messageEndInlineEdit(t.attr("id"))})}),$(".item.message.editable .editMode").live("keydown",function(t){var n=$(this),r=n.closest(".item");t.which==13&&(t.shiftKey||(t.preventDefault(),dC.stopMessageInlineEditAndSaveWithID_body_(r.attr("id"),n.html())&&e.messageEndInlineEdit(r.attr("id"))))}),SCS.err.showError(200,"_message")):SCS.err.showError(510,"_message")},this._transfer=function(){return t.length>0?($(".item.transfer .main .name").live("click",function(){var e=$(this),t=e.closest(".transfer");$(".sub",t).length>0&&(e.hasClass("open")?(e.removeClass("open"),$(".sub",t).removeClass("open")):(e.addClass("open"),$(".sub",t).addClass("open")))}),$(".item.transfer .icon").live("dblclick",function(){var e=$(this),t=e.closest(".transfer"),n=e.closest(".instance");dC.doubleClickIconWithID_index_(t.attr("id"),$(".instance",t).index(n))}),$(".item.transfer button").live("click",function(){var t=$(this),n=t.closest(".transfer"),r=t.closest(".instance");t.hasClass("accept")&&dC.acceptTransferWithID_index_(n.attr("id"),$(".instance",n).index(r))&&e.transferAccept(n.attr("id"),$(".instance",n).index(r)),t.hasClass("decline")&&dC.cancelTransferWithID_index_(n.attr("id"),$(".instance",n).index(r))&&e.transferCancel(n.attr("id"),$(".instance",n).index(r)),t.hasClass("cancel")&&dC.cancelTransferWithID_index_(n.attr("id"),$(".instance",n).index(r))&&e.transferCancel(n.attr("id"),$(".instance",n).index(r)),t.hasClass("delete")&&dC.deleteTransferWithID_index_(n.attr("id"),$(".instance",n).index(r))&&e.transferDelete(n.attr("id"),$(".instance",n).index(r)),t.hasClass("quicklook")&&dC.showTransferInQuickLookWithID_index_(n.attr("id"),$(".instance",n).index(r)),t.hasClass("reveal")&&dC.revealTransferInFinderWithID_index_(n.attr("id"),$(".instance",n).index(r))}),SCS.err.showError(200,"_transfer")):SCS.err.showError(510,"_transfer")},this._nearBottom=function(){return document.body.scrollTop+window.innerHeight>=document.body.offsetHeight-75},this.appendItem=function(n,r){if(t.length>0){var i=e._nearBottom();return $("#typing").length>0?$("#conversation #typing").before(n):t.append(n),r&&i&&e.scrollToEnd(),SCS.err.showError(200,"appendItem")}return SCS.err.showError(510,"appendItem")},this.scrollToItem=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"scrollToItem");if(t.length>0){var n=$("#"+e);return n.length>0?(window.scrollTo(0,n.get(0).offsetTop),SCS.err.showError(200,"scrollToItem")):SCS.err.showError(511,"scrollToItem")}return SCS.err.showError(510,"scrollToItem")},this.prependItem=function(n,r){return t.length>0?(t.prepend(n),r&&e._nearBottom()&&e.scrollToEnd(),SCS.err.showError(200,"prependItem")):SCS.err.showError(510,"prependItem")},this.appendBulk=function(n,r,i,s){if(t.length>0){var o=e._nearBottom();if(typeof i!="undefined"&&i!=""&&$("#"+i).length>0&&typeof s!="undefined")if(s=="before")$("#conversation #"+i).before(n);else{if(s!="after")return SCS.err.showError(514,"appendBulk");$("#conversation #"+i).after(n)}else $("#typing").length>0?$("#conversation #typing").before(n):t.append(n);return r&&o&&e.scrollToEnd(),SCS.err.showError(200,"appendBulk")}return SCS.err.showError(510,"appendBulk")},this.removeItem=function(n,r){if(typeof n=="undefined"||n=="")return SCS.err.showError(513,"removeItem");if(t.length>0){var i=$("#"+n);return i.length>0?($("#"+n).remove(),(r||e._nearBottom()&&r!=0)&&e.scrollToEnd(),SCS.err.showError(200,"removeItem")):SCS.err.showError(511,"scrollToItem")}return SCS.err.showError(510,"removeItem")},this.typingUpdate=function(n,r,i){return t.length>0?(r=="hide"||n==""?$("#typing").addClass("invisible"):($("#typing").length>0&&$("#typing").remove(),t.append(n)),(i||e._nearBottom()&&i!=0)&&e.scrollToEnd(),SCS.err.showError(200,"typingUpdate")):SCS.err.showError(510,"typingUpdate")},this.scrollToEnd=function(){return t.length>0?(window.scrollTo(0,t.outerHeight()),SCS.err.showError(200,"scrollToEnd")):SCS.err.showError(510,"scrollToEnd")},this.transferAccept=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"transferAccept");if(t.length>0){var r=$("#"+e);return r.length>0?typeof n!="undefined"&&typeof n=="number"&&n>=0?(n==0?($(".instance",r).addClass("running"),$(".progress",r).css("width","auto")):($(".instance:eq("+n+")",r).addClass("running"),$(".progress:eq("+n+")",r).css("width","auto")),SCS.err.showError(200,"transferAccept")):SCS.err.showError(512,"transferAccept"):SCS.err.showError(511,"transferAccept")}return SCS.err.showError(510,"transferAccept")},this.transferCancel=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"transferCancel");if(t.length>0){var r=$("#"+e);return r.length>0?typeof n!="undefined"&&typeof n=="number"&&n>=0?(n==0?$(".instance",r).addClass("completed cancelled").removeClass("running waiting"):$(".instance:eq("+n+")",r).addClass("completed cancelled").removeClass("running waiting"),SCS.err.showError(200,"transferCancel")):SCS.err.showError(512,"transferCancel"):SCS.err.showError(511,"transferCancel")}return SCS.err.showError(510,"transferCancel")},this.transferReady=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"transferReady");if(t.length>0){var r=$("#"+e);return r.length>0?typeof n!="undefined"&&typeof n=="number"&&n>=0?(n==0?$(".instance",r).removeClass("waiting"):$(".instance:eq("+n+")",r).removeClass("waiting"),SCS.err.showError(200,"transferReady")):SCS.err.showError(512,"transferReady"):SCS.err.showError(511,"transferReady")}return SCS.err.showError(510,"transferReady")},this.transferPosition=function(e,n,r,i,s){return typeof e=="undefined"||e==""?SCS.err.showError(513,"transferPosition"):typeof n!="number"||n<0?SCS.err.showError(512,"transferPosition"):(typeof i=="undefined"&&(i=""),r>100?r=100:r<0&&(r=0),$ft=$("#"+e+""),t.length>0?$ft.length>0&&$(".progress:eq("+n+")",$ft).length>0&&$(".size:eq("+n+")",$ft).length>0?(typeof s=="undefined"||s==0?$(".progress:eq("+n+")",$ft).removeClass("hidden").css("width",r+"%"):$(".progress:eq("+n+")",$ft).addClass("hidden").css("width",""),$(".size:eq("+n+")",$ft).html(i),SCS.err.showError(200,"transferPosition")):SCS.err.showError(511,"transferPosition"):SCS.err.showError(510,"transferPosition"))},this.transferComplete=function(e,n){if(t.length>0){var r=$("#"+e);return r.length>0?typeof n!="undefined"&&typeof n=="number"&&n>=0?(n==0?$(".instance",r).addClass("completed").removeClass("running"):$(".instance:eq("+n+")",r).addClass("completed").removeClass("running"),SCS.err.showError(200,"transferComplete")):SCS.err.showError(512,"transferComplete"):SCS.err.showError(511,"transferComplete")}return SCS.err.showError(510,"transferComplete")},this.transferUpdateHead=function(e,n,r,i){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"transferUpdateHead");var s=$("#"+e+"");return typeof i=="undefined"&&(i=""),typeof n!="number"||typeof n=="undefined"?SCS.err.showError(512,"transferUpdateHead"):t.length>0?s.length>0&&$(".time:eq("+n+")",s).length>0?($(".time:eq("+n+")",s).removeClass("cancelled rejected sending sent missing").addClass(r).html(i),SCS.err.showError(200,"transferUpdateHead")):SCS.err.showError(511,"transferUpdateHead"):SCS.err.showError(510,"transferUpdateHead")},this.transferUpdateStatus=function(e,n,r){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"transferUpdateStatus");var i=$("#"+e+"");return typeof text=="undefined"&&(text=""),typeof n!="number"||typeof n=="undefined"?SCS.err.showError(512,"transferUpdateStatus"):t.length>0?i.length>0&&$(".instance:eq("+n+")",i).length>0?($(".instance:eq("+n+")",i).removeClass("waiting running connecting completed cancelled failed missing").addClass(r),SCS.err.showError(200,"transferUpdateStatus")):SCS.err.showError(511,"transferUpdateStatus"):SCS.err.showError(510,"transferUpdateStatus")},this.voicemailPlay=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"voicemailPlay");var n=$("#"+e+"");return t.length>0?n.length>0?(n.removeClass("new"),$(".control",n).removeClass("play").addClass("stop"),$(".progress",n).removeClass("hidden").css("width",""),SCS.err.showError(200,"voicemailPlay")):SCS.err.showError(511,"voicemailPlay"):SCS.err.showError(510,"voicemailPlay")},this.voicemailStop=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"voicemailStop");var n=$("#"+e+"");return t.length>0?n.length>0?($(".control",n).removeClass("stop").addClass("play"),$(".progress",n).addClass("hidden").css("width",""),SCS.err.showError(200,"voicemailStop")):SCS.err.showError(511,"voicemailStop"):SCS.err.showError(510,"voicemailStop")},this.voicemailPosition=function(e,n,r){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"voicemailPosition");typeof r=="undefined"&&(r=""),n>100?n=100:n<0&&(n=0);var i=$("#"+e+"");return t.length>0?i.length>0&&$(".progress",i).length>0&&$(".played",i).length>0?($(".progress",i).removeClass("hidden").css("width",n+"%"),$(".played",i).html(r),SCS.err.showError(200,"voicemailPosition")):SCS.err.showError(511,"voicemailPosition"):SCS.err.showError(510,"voicemailPosition")},this.smsUpdateStatus=function(e,n,r,i){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"smsUpdateStatus");var s=$("#"+e+"");return typeof i=="undefined"&&(i=""),typeof n!="number"||typeof n=="undefined"?SCS.err.showError(512,"smsUpdateStatus"):t.length>0?s.length>0&&$(".time:eq("+n+")",s).length>0?($(".time:eq("+n+")",s).removeClass("failed sending sent").addClass(r).html(i),SCS.err.showError(200,"smsUpdateStatus")):SCS.err.showError(511,"smsUpdateStatus"):SCS.err.showError(510,"smsUpdateStatus")},this.messageMarkAs=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageMarkAs");var r=$("#"+e+"");return t.length>0?r.length>0?(n=="read"?r.addClass(n):n=="unread"?r.removeClass("read"):r.removeClass("edited deleted sending").addClass(n),SCS.err.showError(200,"messageMarkAs")):SCS.err.showError(511,"messageMarkAs"):SCS.err.showError(510,"messageMarkAs")},this.messageEnableEdit=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageEnableEdit");var n=$("#"+e+"");return t.length>0?n.length>0?(n.addClass("editable"),SCS.err.showError(200,"messageEnableEdit")):SCS.err.showError(511,"messageEnableEdit"):SCS.err.showError(510,"messageEnableEdit")},this.messageDisableEdit=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageDisableEdit");var n=$("#"+e+"");return t.length>0?n.length>0?(n.removeClass("editable"),SCS.err.showError(200,"messageDisableEdit")):SCS.err.showError(511,"messageDisableEdit"):SCS.err.showError(510,"messageDisableEdit")},this.messageUpdate=function(n,r,i,s){if(typeof n=="undefined"||n=="")return SCS.err.showError(513,"messageUpdate");var o=$("#"+n+"");return t.length>0?o.length>0&&o.hasClass("message")?(s!="undefined"&&s!=null&&e.messageMarkAs(n,s),r!=null&&$(".body",o).html(r),i!=null&&$(".time",o).html(i),o.css("display","inline").css("display","block"),SCS.err.showError(200,"messageUpdate")):SCS.err.showError(511,"messageUpdate"):SCS.err.showError(510,"messageUpdate")},this.messageFollowupStatus=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageFollowupStatus");var r=$("#"+e+"");return t.length>0?r.length>0&&r.hasClass("message")?(n==0?r.removeClass("followup"):r.addClass("followup"),SCS.err.showError(200,"messageFollowupStatus")):SCS.err.showError(511,"messageFollowupStatus"):SCS.err.showError(510,"messageFollowupStatus")},this.messageStartInlineEdit=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageStartInlineEdit");var n=$("#"+e+"");return t.length>0?n.length>0&&n.hasClass("message")?(n.find(".body").attr("contentEditable","true").addClass("editMode"),SCS.err.showError(200,"messageStartInlineEdit")):SCS.err.showError(511,"messageStartInlineEdit"):SCS.err.showError(510,"messageStartInlineEdit")},this.messageEndInlineEdit=function(e){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"messageEndInlineEdit");var n=$("#"+e+"");return t.length>0?n.length>0&&n.hasClass("message")?(n.find(".body").attr("contentEditable","false").removeClass("editMode"),SCS.err.showError(200,"messageEndInlineEdit")):SCS.err.showError(511,"messageEndInlineEdit"):SCS.err.showError(510,"messageEndInlineEdit")},this.isInViewport=function(e,n){if(typeof e=="undefined"||e=="")return SCS.err.showError(513,"isInViewport");var r=$("#"+e+"");if(t.length>0){if(r.length>0){var i=window.scrollY,s=window.scrollY+window.innerHeight,o=r.position().top+r.outerHeight();return n&&(o=r.position().top),o>=i&&o<=s?!0:!1}return SCS.err.showError(511,"isInViewport")}return SCS.err.showError(510,"isInViewport")},this.init=function(){return t=$("#conversation"),e._dc(),e._init(),e._item(),e._history(),e._message(),e._voicemail(),e._transfer(),SCS.err.showError(200,"init")}},SCS.id=new SCS.Identifier,SCS.conv=new SCS.Conversation,SCS.err=new SCS.ErrorHandler,$(function(){SCS.conv.init()});