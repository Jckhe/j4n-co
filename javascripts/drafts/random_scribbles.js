/* Author: Poops Drewniak
    
*/
function onDocumentMouseMove(e){ballSprite.position.set(e.clientX,e.clientY,0),mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=-(e.clientY/window.innerHeight)*2+1,update()}function buildAxes(e){var t=new THREE.Object3D;return t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(e,0,0),16711680,!1)),t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(-e,0,0),16711680,!0)),t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(0,e,0),65280,!1)),t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(0,-e,0),65280,!0)),t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,e),255,!1)),t.add(buildAxis(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,-e),255,!0)),t}function buildAxis(e,t,n,r){var i=new THREE.Geometry,s;r?s=new THREE.LineDashedMaterial({linewidth:3,color:n,dashSize:3,gapSize:3}):s=new THREE.LineBasicMaterial({linewidth:3,color:n}),i.vertices.push(e.clone()),i.vertices.push(t.clone()),i.computeLineDistances();var o=new THREE.Line(i,s,THREE.LinePieces);return o}function animate(){requestAnimationFrame(animate),renderer.render(scene,camera)}function addCube(){var e=new THREE.CubeGeometry(50,50,50),t=new THREE.MeshBasicMaterial,n=new THREE.Mesh(e,t);n.position.set(see.x,see.y,0),scene.add(n),console.log("addCube")}function update(){var e=new THREE.Vector3(mouse.x,mouse.y,1);projector.unprojectVector(e,camera);var t=new THREE.Raycaster(camera.position,e.sub(camera.position).normalize());console.log("cube.y"+cube.position.y),console.log("ray.y"+t.ray.direction.y),see.x=t.ray.direction.x*1e3,see.y=t.ray.direction.y*1e3,addCube()}var camera,scene,renderer,projector;scene=new THREE.Scene;var mouse={x:0,y:0},VIEW_ANGLE=45,ASPECT=$(window).width()/$(window).height(),NEAR=.1,FAR=2e4;camera=new THREE.PerspectiveCamera(VIEW_ANGLE,ASPECT,NEAR,FAR),scene.add(camera),camera.position.set(0,100,800),camera.lookAt(scene.position),camera.lookAt(scene.position);var size=500,step=50,geometry=new THREE.Geometry;for(var i=-size;i<=size;i+=step)geometry.vertices.push(new THREE.Vector3(-size,0,i)),geometry.vertices.push(new THREE.Vector3(size,0,i)),geometry.vertices.push(new THREE.Vector3(i,0,-size)),geometry.vertices.push(new THREE.Vector3(i,0,size));var material=new THREE.LineBasicMaterial({color:0,opacity:.2}),line=new THREE.Line(geometry,material);line.type=THREE.LinePieces,scene.add(line);var axes=buildAxes(1e3);scene.add(axes);var ballTexture=THREE.ImageUtils.loadTexture("icons/apple-touch-icon-144x144-precomposed.png");ballSprite=new THREE.Sprite({map:ballTexture,useScreenCoordinates:!0,alignment:THREE.SpriteAlignment.center}),ballSprite.position.set(50,50,0),scene.add(ballSprite),projector=new THREE.Projector,document.addEventListener("mousemove",onDocumentMouseMove,!1),renderer=new THREE.CanvasRenderer,renderer.setSize(window.innerWidth,window.innerHeight);var range=50;geom=new THREE.CubeGeometry(50,50,50);var grayness=Math.random()*.5+.25;mat=new THREE.MeshBasicMaterial,cube=new THREE.Mesh(new THREE.CubeGeometry(50,50,50),new THREE.MeshNormalMaterial),mat.color.setRGB(grayness,grayness,grayness),cube.position.set(0,0,0),cube.rotation.set(Math.random(),Math.random(),Math.random()).multiplyScalar(2*Math.PI),cube.grayness=grayness,$("body").append(renderer.domElement),$(document).keydown(function(e){console.log("x:"+camera.position.x+" y:"+camera.position.y+" z:"+camera.position.z);switch(e.keyCode){case 38:console.log(camera.position.x),camera.position.y+=10;break;case 40:camera.position.y-=10;break;case 37:camera.position.x-=10;break;case 39:camera.position.x+=10}renderer.render(scene,camera)}),$("body").css("overflow","hidden"),camera.lookAt(scene.position),renderer.render(scene,camera),animate();var see={};see.x=mouse.x,see.y=mouse.y;